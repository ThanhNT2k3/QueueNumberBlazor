@if (IsOpen)
{
    <div class="modal-backdrop fade @(IsOpen ? "show" : "")" @onclick="OnBackdropClick"></div>
    <div class="modal fade @(IsOpen ? "show d-block" : "")" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered modal-@Size @(Scrollable ? "modal-dialog-scrollable" : "")">
            <div class="modal-content">
                @if (ShowHeader)
                {
                    <div class="modal-header border-0">
                        @if (HeaderContent != null)
                        {
                            @HeaderContent
                        }
                        else
                        {
                            <h5 class="modal-title fw-bold">@Title</h5>
                        }
                        @if (ShowCloseButton)
                        {
                            <button type="button" class="btn-close" @onclick="Close"></button>
                        }
                    </div>
                }
                <div class="modal-body">
                    @BodyContent
                </div>
                @if (FooterContent != null)
                {
                    <div class="modal-footer border-0">
                        @FooterContent
                    </div>
                }
            </div>
        </div>
    </div>
}

<style>
    .modal-backdrop {
        background-color: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(4px);
        animation: fadeIn 0.3s ease-out;
    }

    .modal.show {
        animation: fadeIn 0.3s ease-out;
    }

    .modal-content {
        border-radius: 16px;
        border: none;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        animation: slideUp 0.3s ease-out;
    }

    .modal-header {
        padding: 1.5rem 1.5rem 1rem;
    }

    .modal-title {
        color: #1e293b;
        font-size: 1.25rem;
    }

    .modal-body {
        padding: 1rem 1.5rem;
        color: #475569;
    }

    .modal-footer {
        padding: 1rem 1.5rem 1.5rem;
        background: #f8fafc;
        border-bottom-left-radius: 16px;
        border-bottom-right-radius: 16px;
    }

    @@keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    @@keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>

@code {
    [Parameter] public bool IsOpen { get; set; }
    [Parameter] public EventCallback<bool> IsOpenChanged { get; set; }
    [Parameter] public string? Title { get; set; }
    [Parameter] public RenderFragment? HeaderContent { get; set; }
    [Parameter] public RenderFragment? BodyContent { get; set; }
    [Parameter] public RenderFragment? FooterContent { get; set; }
    [Parameter] public bool ShowHeader { get; set; } = true;
    [Parameter] public bool ShowCloseButton { get; set; } = true;
    [Parameter] public bool CloseOnBackdropClick { get; set; } = true;
    [Parameter] public string Size { get; set; } = "md"; // sm, md, lg, xl
    [Parameter] public bool Scrollable { get; set; } = false;
    [Parameter] public EventCallback OnClose { get; set; }

    private async Task Close()
    {
        IsOpen = false;
        await IsOpenChanged.InvokeAsync(IsOpen);
        await OnClose.InvokeAsync();
    }

    private async Task OnBackdropClick()
    {
        if (CloseOnBackdropClick)
        {
            await Close();
        }
    }
}
